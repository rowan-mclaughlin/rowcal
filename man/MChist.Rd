% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MChist.R
\name{MChist}
\alias{MChist}
\title{Bootstrapped Histogram for Radiocarbon Data}
\usage{
MChist(
  datelist,
  bw = 100,
  buffer = 300,
  Nboot = 100,
  default_curve = "intcal",
  plot = TRUE,
  xlab = "Cal. BC/AD",
  col.error = "black",
  lwd.error = 1,
  lty.error = 1,
  ...
)
}
\arguments{
\item{datelist}{A matrix or dataframe with two or three columns:
\itemize{
\item Column 1: Radiocarbon years (BP).
\item Column 2: Associated errors (standard deviations).
\item Column 3 (optional): Calibration curve. Defaults to \code{'intcal'} if not provided.
}}

\item{bw}{Numeric. The bin width for the histogram. Defaults to \code{100}.}

\item{buffer}{Numeric. Additional range to extend beyond the minimum and maximum calibrated dates. Defaults to \code{300}.}

\item{Nboot}{Integer. Number of bootstrap iterations to perform. Defaults to \code{100}.}

\item{default_curve}{Character. The default calibration curve to use if the third column of \code{datelist} is missing. Defaults to \code{'intcal'}.}

\item{plot}{Logical. If \code{TRUE}, plots the histogram. If \code{FALSE}, returns the histogram object. Defaults to \code{TRUE}.}

\item{xlab}{Character. Label for the x-axis. Defaults to \code{'Cal. BC/AD'}.}

\item{col.error}{Character. Color of error bars in the plot. Defaults to \code{'black'}.}

\item{lwd.error}{Numeric. Line width for error bars. Defaults to \code{1}.}

\item{lty.error}{Numeric. Line type for error bars. Defaults to \code{1}.}

\item{...}{Additional arguments passed to the \code{\link{plot}} function.}
}
\value{
If \code{plot = TRUE}, a histogram plot is generated. If \code{plot = FALSE}, an object of class \code{'MChistogram'} is returned.
The object includes the following elements:
\itemize{
\item \code{mids}: Midpoints of the histogram bins.
\item \code{counts}: Mean counts per bin across bootstraps.
\item \code{bootstrapped_counts}: Matrix of bootstrapped counts for each bin.
}
}
\description{
Generates a bootstrapped histogram for radiocarbon data, incorporating calibration uncertainty into the distribution.
The histogram bins are determined by a specified bin width, and the output can be either a plot or the histogram object.
}
\details{
The function creates a histogram of calibrated radiocarbon dates with uncertainty incorporated through Monte Carlo resampling.
The calibration uncertainty is captured by bootstrapping (\code{Nboot} iterations) and represented as error bars if plotted.

The calibration process uses the \code{\link{rowcalmode}} function to identify the mode of the calibrated ranges.
Outlying values during bootstrapping are handled with error-catching. If frequent errors occur, consider increasing the \code{buffer} to e.g. 500 years.
}
\examples{
\dontrun{
# Example data
datelist <- data.frame(
  BP = c(4000, 4200, 4400, 4300, 5000),
  error = c(50, 60, 40, 25,25),
  calcurve = c('intcal', 'intcal', 'intcal', 'intcal','marine')
)

# Create and plot a bootstrapped histogram
MChist(datelist, bw = 200, Nboot = 50, col.error = 'red')

# Retrieve the histogram object without plotting
hist_obj <- MChist(datelist, plot = FALSE)
}

}
\seealso{
\code{\link{MCmix}}, \code{\link{rowcalmode}}
}
