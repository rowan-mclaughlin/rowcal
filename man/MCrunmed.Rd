% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MCrumned.R
\name{MCrunmed}
\alias{MCrunmed}
\title{Simulate and Compute Running Median for Chronological Data}
\usage{
MCrunmed(
  cal = NULL,
  unif = NULL,
  x = list(),
  y = NULL,
  calcurve = "intcal",
  N = 100,
  y_blur = 0,
  k = 51
)
}
\arguments{
\item{cal}{A matrix of radiocarbon data with 3 or 4 columns:
\itemize{
\item Column 1: Radiocarbon years (14C age).
\item Column 2: Standard deviation of radiocarbon years.
\item Column 3 (optional): Calibration curve names. Defaults to \code{calcurve}.
\item Column 4: Response variable.
}
Default is \code{NULL}.}

\item{unif}{A matrix of uniform chronological data with 3 columns:
\itemize{
\item Column 1: Start of uniform interval (x0).
\item Column 2: End of uniform interval (x1).
\item Column 3: Response variable (y).
}
Default is \code{NULL}.}

\item{x}{A list of calibrated or uniform chronological data for simulation. Default is an empty list.}

\item{y}{A vector of response variable values associated with \code{x}. Default is \code{NULL}.}

\item{calcurve}{A character string specifying the calibration curve to use when processing
radiocarbon data. Default is "intcal".}

\item{N}{The number of Monte Carlo simulations to perform. Default is 100.}

\item{y_blur}{The standard deviation of Gaussian noise added to \code{y} values. Default is 0 (no noise).}

\item{k}{The width of the running median window (number of points). Default is 51.}
}
\value{
A list of class \code{MCr}, where each element is a two-column matrix containing:
\itemize{
\item Simulated chronological values (column 1).
\item Corresponding running medians of the response variable (column 2).
}
}
\description{
The \code{MCrunmed} function combines input chronological data and associated response
variables, performs Monte Carlo simulations to generate random samples, and computes
a running median for the response variable across the simulated data.
}
\details{
The function:
\enumerate{
\item Validates and processes input data (\code{cal} and \code{unif}) to generate chronological samples.
\item Simulates chronological data using Monte Carlo methods.
\item Computes the temporal order of simulated data.
\item Applies a running median to the response variable, optionally adding noise to \code{y}.
}

The three options for input, \code{x} and \code{y}, \code{cal}, and \code{unif} combined if provided. The resulting data is then simulated
and processed together.

The returned list can be interpolated to a regular time grid with \code{\link{MCr.as.MCd}}
}
\examples{
# Example data
x0 <- c(-5010, -5110, -5350) # from
x1 <- c(-5000, -5100, -5200) # to
y <- c(0.2, 0.7, 0.9)

# Perform Monte Carlo simulation
result <- MCrunmed(x0, x1, y, k = 3, N = 10, blur = 0.1)

# Access the first simulation
head(result[[1]])

}
\seealso{
\code{\link{runmed}} \code{\link{MCr.as.MCd}} \code{\link{rowunif}} \code{\link{rowcal}}
}
\author{
T. Rowan McLaughlin
}
